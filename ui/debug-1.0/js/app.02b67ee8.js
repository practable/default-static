(function(e){function t(t){for(var r,a,s=t[0],c=t[1],d=t[2],l=0,f=[];l<s.length;l++)a=s[l],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,d||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,s=1;s<n.length;s++){var c=n[s];0!==o[c]&&(r=!1)}r&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={app:0},i=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/ui/debug-1.0/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var u=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"003f":function(e,t,n){},"470f":function(e,t,n){"use strict";n("fdbf")},"84e6":function(e,t,n){},b4f3:function(e,t,n){"use strict";n("84e6")},c0cb:function(e,t,n){"use strict";n("003f")},cd49:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getConnectionDroppedAt",(function(){return c})),n.d(r,"getConnectionIsDropped",(function(){return d})),n.d(r,"getDataURL",(function(){return u})),n.d(r,"getDataURLObtained",(function(){return l})),n.d(r,"getExpiry",(function(){return f})),n.d(r,"getExpiryObtained",(function(){return b})),n.d(r,"getLastVideoCheck",(function(){return p})),n.d(r,"getLastVideoWrite",(function(){return m})),n.d(r,"getStream",(function(){return O})),n.d(r,"getStreams",(function(){return h})),n.d(r,"getStreamsObtained",(function(){return j})),n.d(r,"getVideoURL",(function(){return v})),n.d(r,"getVideoURLObtained",(function(){return g}));var o={};n.r(o),n.d(o,"login",(function(){return y})),n.d(o,"clear",(function(){return x})),n.d(o,"deleteToken",(function(){return k})),n.d(o,"deleteBearer",(function(){return w}));var i={};n.r(i),n.d(i,"deleteDataURL",(function(){return L})),n.d(i,"deleteExpiry",(function(){return S})),n.d(i,"deleteStreams",(function(){return C})),n.d(i,"deleteVideoURL",(function(){return D})),n.d(i,"setConnectionDroppedAt",(function(){return U})),n.d(i,"setConnectionIsDropped",(function(){return R})),n.d(i,"setDataURL",(function(){return E})),n.d(i,"setExpiry",(function(){return $})),n.d(i,"setLastVideoCheck",(function(){return V})),n.d(i,"setLastVideoWrite",(function(){return Y})),n.d(i,"setStreams",(function(){return A})),n.d(i,"setVideoURL",(function(){return q}));n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("f2bf"),s=n("5502"),c=(n("4de4"),function(e){return e.connectionDroppedAt}),d=function(e){return e.connectionIsDropped},u=function(e){return e.dataURL},l=function(e){return e.dataURLObtained},f=function(e){return e.expiry},b=function(e){return e.expiryObtained},p=function(e){return e.lastVideoCheck},m=function(e){return e.lastVideoWrite},O=function(e,t){return function(t){if(!e.streamsObtained)return{};var n=e.streams.filter((function(e){return e.for==t}));return n.length<1?{}:n[0]}},h=function(e){return e.streams},j=function(e){return e.streamsObtained},v=function(e){return e.videoURL},g=function(e){return e.videoURLObtained},y=function(e){var t=e.commit;t("login")},x=function(e){var t=e.commit;t("clear")},k=function(e){var t=e.commit;t("deleteToken")},w=function(e){var t=e.commit;t("deleteBearer")},L=function(e,t){e.dataURL="",e.dataURLObtained=!1},S=function(e){e.expiry=-1,e.expiryObtained=!1},C=function(e){e.streams={},e.streamsObtained=!1},D=function(e,t){e.videoURL="",e.videoURLObtained=!1},U=function(e,t){e.connectionDroppedAt=t},R=function(e,t){e.connectionIsDropped=t},E=function(e,t){e.dataURL=t,e.dataURLObtained=!0},$=function(e,t){e.expiry=t,e.expiryObtained=!0},V=function(e,t){e.lastVideoCheck=t},Y=function(e,t){e.lastVideoWrite=t},A=function(e,t){e.streams=t,e.streamsObtained=!0},q=function(e,t){e.videoURL=t,e.videoURLObtained=!0},T={connectionDroppedAt:0,connectionIsDropped:!1,dataURL:"",dataURLObtained:!1,expiry:-1,expiryObtained:!1,lastVideoCheck:0,lastVideoWrite:0,streams:[],streamsObtained:!1,videoURL:"",videoURLObtained:!1},W=Object(s["a"])({state:T,getters:r,actions:o,mutations:i}),M=W,P=Object(a["h"])("img",{width:"300",src:"https://assets.practable.io/images/common/practable-logo-3-1980x660.png"},null,-1),I={id:"nav"},F=Object(a["g"])("Connections"),B=Object(a["g"])(" | "),z=Object(a["g"])("About"),_=Object(a["h"])("p",{style:{"margin-bottom":"0.7cm"}},null,-1);function H(e,t,n,r,o,i){var s=Object(a["v"])("router-link"),c=Object(a["v"])("router-view");return Object(a["q"])(),Object(a["d"])(a["a"],null,[P,Object(a["h"])("div",I,[Object(a["h"])(s,{to:"/"},{default:Object(a["A"])((function(){return[F]})),_:1}),B,Object(a["h"])(s,{to:"/about"},{default:Object(a["A"])((function(){return[z]})),_:1})]),_,Object(a["h"])(c)],64)}var K={name:"App",components:{}};n("c0cb");K.render=H;var N=K,G=n("6c02"),J={class:"container-fluid align-center"},Q=Object(a["h"])("h1",null,"About",-1),X=Object(a["h"])("p",null," This is a diagnostic interface to show developers what information the booking system has passed to their user interface. User interfaces typically require to connect to video and data streams, using authentication, with time limits and with different read/write scopes. If this page is working, but your user interface for same piece of hardware is not, then check again your implementation of the stream decoding, and (re)connection process, using this page as an example. Note that this interface implements both store and router to mimic a typical interface, placing the query params in the store upon loading, so that when using the router to navigate between pages, the streams information is not lost.",-1);function Z(e,t){return Object(a["q"])(),Object(a["d"])("div",J,[Q,X])}const ee={};ee.render=Z;var te=ee;function ne(e,t){return Object(a["q"])(),Object(a["d"])("h1",null,"Oops, it looks like the page you're looking for doesn't exist.")}const re={};re.render=ne;var oe=re,ie={class:"row"},ae={class:"col"},se=Object(a["h"])("h1",null," Connection diagnostics ",-1),ce={class:"col"},de=Object(a["h"])("h1",null," Video ",-1),ue={class:"col"},le=Object(a["h"])("h1",null," Data ",-1);function fe(e,t,n,r,o,i){var s=Object(a["v"])("display-expiry"),c=Object(a["v"])("display-connections"),d=Object(a["v"])("display-video"),u=Object(a["v"])("display-data");return Object(a["q"])(),Object(a["d"])("div",ie,[Object(a["h"])("div",ae,[se,Object(a["h"])(s,{exp:e.exp},null,8,["exp"]),Object(a["h"])(c,{streams:e.decodedStreams},null,8,["streams"])]),Object(a["h"])("div",ce,[de,Object(a["h"])(d,{stream:e.videoStream},null,8,["stream"])]),Object(a["h"])("div",ue,[le,Object(a["h"])(u,{stream:e.dataStream},null,8,["stream"])])])}function be(e,t,n,r,o,i){var s=Object(a["v"])("display-connection");return Object(a["q"])(!0),Object(a["d"])(a["a"],null,Object(a["u"])(e.streams,(function(e,t){return Object(a["q"])(),Object(a["d"])(s,{stream:e,key:e.for},null,8,["stream"])})),128)}function pe(e,t,n,r,o,i){return Object(a["q"])(),Object(a["d"])(a["a"],null,[Object(a["h"])("h3",null,Object(a["x"])(e.stream.for),1),Object(a["h"])("p",null,Object(a["x"])(e.stream.verb)+" to "+Object(a["x"])(e.stream.url),1),Object(a["h"])("p",null," Scopes: "+Object(a["x"])(e.stream.permission.scopes),1),Object(a["h"])("p",null," Token: "+Object(a["x"])(e.tokenSnippet),1)],64)}n("fb6a"),n("d3b7"),n("25f0");var me=n("1232"),Oe=Object(a["i"])({name:"DisplayConnection",props:["stream"],computed:{decoded:function(){try{return JSON.stringify(Object(me["a"])(this.stream.token),void 0,2)}catch(e){return"could not decode token"}},tokenSnippet:function(){if(this.stream.hasOwnProperty("token")){var e=this.stream.token,t=e.substring(0,6),n=e.length.toString(),r=e.slice(e.length-6);return t+"..."+r+" ("+n+" chars)"}return"(none supplied)"}}});Oe.render=pe;var he=Oe,je=Object(a["i"])({name:"DisplayConnections",props:["streams"],components:{"display-connection":he}});je.render=be;var ve=je,ge={key:0},ye={key:1};function xe(e,t,n,r,o,i){return Object(a["q"])(),Object(a["d"])(a["a"],null,[Object(a["g"])(" This session "+Object(a["x"])(e.finishWord)+" at "+Object(a["x"])(e.finishes)+" ",1),e.expired?Object(a["e"])("",!0):(Object(a["q"])(),Object(a["d"])("div",ge,"which is in "+Object(a["x"])(e.timerCount)+" seconds",1)),e.expired?(Object(a["q"])(),Object(a["d"])("div",ye,"which was "+Object(a["x"])(e.ago)+" seconds ago",1)):Object(a["e"])("",!0)],64)}var ke=n("ad15"),we=n.n(ke),Le=Object(a["i"])({name:"DisplayExpiry",props:["exp"],data:function(){return{timerCount:0}},computed:{finishes:function(){return we.a.unix(this.exp).format("h:mm A")},finishWord:function(){return this.expired?"finished":"finishes"},expired:function(){return this.timerCount<1},ago:function(){return-1*this.timerCount}},watch:{exp:function(e,t){this.timerCount=this.exp-we()().unix()},timerCount:{handler:function(e){var t=this;setTimeout((function(){t.timerCount--}),1e3)},immediate:!0}}});Le.render=xe;var Se=Le;function Ce(e,t,n,r,o,i){var s=Object(a["v"])("data-element");return Object(a["q"])(),Object(a["d"])(a["a"],null,[e.urlOK?(Object(a["q"])(),Object(a["d"])(s,{key:0,url:e.url},null,8,["url"])):Object(a["e"])("",!0),Object(a["g"])(" "+Object(a["x"])(e.url),1)],64)}var De={class:"col"},Ue=Object(a["f"])('<div class="row"><h4> Read </h4></div><div class="row"><div id="data-box" class="textbox" contenteditable="true"></div></div><div class="row"><h4> Write </h4></div><div class="row"><div id="cmd-box" class="textbox" contenteditable="true"></div></div>',4),Re={class:"row"},Ee=Object(a["g"])(" Clear "),$e=Object(a["h"])("span",{class:"caret"},null,-1),Ve=Object(a["g"])(" Send "),Ye=Object(a["h"])("span",{class:"caret"},null,-1);function Ae(e,t,n,r,o,i){return Object(a["q"])(),Object(a["d"])("div",De,[Ue,Object(a["h"])("div",Re,[Object(a["h"])("button",{type:"button",onClick:t[1]||(t[1]=function(){return e.clear&&e.clear.apply(e,arguments)}),class:"btn btn-secondary",id:"cmd-btn"},[Ee,$e]),Object(a["h"])("button",{type:"button",onClick:t[2]||(t[2]=function(){return e.send&&e.send.apply(e,arguments)}),class:"btn btn-primary",id:"cmd-btn"},[Ve,Ye])])])}var qe=Object(a["i"])({name:"DataElement",props:["url"],data:function(){return{connection:null}},methods:{send:function(){var e=document.getElementById("cmd-box");e&&this.connection&&this.connection.send(e.innerHTML)},clear:function(){var e=document.getElementById("cmd-box");e&&(e.innerHTML="")}},mounted:function(){this.connection=new WebSocket(this.url),console.log("opening data socket"),this.connection.addEventListener("open",(function(e){console.log("data connection open")})),this.connection.addEventListener("message",(function(e){var t=document.getElementById("data-box");t&&(t.innerHTML=e.data)}))}});n("b4f3");qe.render=Ae;var Te=qe,We=n("bc3a"),Me=n.n(We),Pe=Object(a["i"])({name:"DisplayData",components:{"data-element":Te},props:["stream"],computed:{urlOK:function(){return this.$store.getters.getDataURLObtained},streamOK:function(){return this.stream},url:function(){return this.$store.getters.getDataURL},getConnectionCount:function(){return this.$store.getters.getConnectionCount}},methods:{getWebsocketConnection:function(){var e=this.stream.url,t=this.stream.token,n=this.$store;n.commit("deleteDataURL"),Me.a.post(e,{},{headers:{Authorization:t}}).then((function(e){n.commit("setDataURL",e.data.uri)})).catch((function(e){return console.log(e)}))}},mounted:function(){var e=this,t=function(){e.getWebsocketConnection()};document.addEventListener("streams:dropped",t)},watch:{streamOK:function(e,t){e&&this.getWebsocketConnection()}}});Pe.render=Ce;var Ie=Pe;function Fe(e,t,n,r,o,i){var s=Object(a["v"])("video-element");return Object(a["q"])(),Object(a["d"])(a["a"],null,[Object(a["h"])("div",null,[e.urlOK?(Object(a["q"])(),Object(a["d"])(s,{key:0,url:e.url},null,8,["url"])):Object(a["e"])("",!0)]),Object(a["g"])(" "+Object(a["x"])(e.url),1)],64)}var Be={id:"videoWrapper"};function ze(e,t,n,r,o,i){return Object(a["q"])(),Object(a["d"])("div",Be)}var _e=n("7a33"),He=n.n(_e),Ke=Object(a["i"])({name:"VideoElement",props:["url"],mounted:function(){this.player=new He.a.VideoElement("#videoWrapper",this.url,{autoplay:!0,chunkSize:10485760})}});n("470f");Ke.render=ze;var Ne=Ke,Ge=Object(a["i"])({name:"DisplayVideo",components:{"video-element":Ne},props:["stream"],computed:{urlOK:function(){return this.$store.getters.getVideoURLObtained},streamOK:function(){return this.stream},url:function(){return this.$store.getters.getVideoURL}},methods:{accessVideo:function(){var e=this.stream.url,t=this.stream.token,n=this.$store;n.commit("deleteVideoURL"),Me.a.post(e,{},{headers:{Authorization:t}}).then((function(e){n.commit("setVideoURL",e.data.uri)})).catch((function(e){return console.log(e)}))}},mounted:function(){var e=this,t=function(){e.accessVideo()};document.addEventListener("streams:dropped",t)},watch:{streamOK:function(e,t){e&&this.accessVideo()}}});Ge.render=Fe;var Je=Ge,Qe=n("5a0c"),Xe=n.n(Qe),Ze=Object(a["i"])({name:"Activity",components:{"display-connections":ve,"display-video":Je,"display-data":Ie,"display-expiry":Se},computed:{id:function(){return this.$route.params.id},decodedStreams:function(){return this.$store.getters.getStreams},streamsObtained:function(){return this.$store.getters.getStreamsObtained},videoStream:function(){return this.$store.getters.getStream("video")},dataStream:function(){return this.$store.getters.getStream("data")},exp:function(){return this.$store.getters.getExpiry},expObtained:function(){return this.$store.getters.getExpiryObtained}},mounted:function(){if(!this.streamsObtained){try{var e=JSON.parse(decodeURIComponent(String(this.$route.query.streams)));this.$store.commit("setStreams",e)}catch(a){console.log("error decoding streams",a),this.$store.commit("deleteStreams")}try{var t=this.$route.query.exp;this.$store.commit("setExpiry",t)}catch(a){console.log("error obtaining expiry",a),this.$store.commit("deleteExpiry")}var n=this,r=function(){n.$store.commit("setLastVideoWrite",Xe()().valueOf())};document.addEventListener("jsmpeg:write",(function(){r()}));var o=function(){var e=n.$store.getters.getExpiry;if(e<=Xe()().unix()){var t=new Event("streams:expired");document.dispatchEvent(t)}else{var r=n.$store.getters.getLastVideoCheck,o=n.$store.getters.getLastVideoWrite,i=function(){n.$store.commit("setConnectionIsDropped",!0),n.$store.commit("setConnectionDroppedAt",Xe()().unix());var e=new Event("streams:dropped");document.dispatchEvent(e)};if(r>o){if(n.$store.getters.getConnectionIsDropped){var a=n.$store.getters.getConnectionDroppedAt,s=Xe()().unix()-a;return void(s>10&&i())}i()}else n.$store.commit("setLastVideoCheck",Xe()().valueOf()),n.$store.commit("setConnectionIsDropped",!1)}},i=setInterval(o,1e3);document.addEventListener("streams:expired",(function(){clearInterval(i)}))}},watch:{$route:function(e,t){console.log("Activity:",e,t)}}});Ze.render=fe;var et=Ze,tt=[{path:"/",name:"Home",component:et},{path:"/about",name:"about",component:te},{path:"/:pathMatch(.*)*",name:"not-found",component:oe}],nt=Object(G["a"])({history:Object(G["b"])("/ui/debug-1.0/"),routes:tt}),rt=nt,ot=n("2510"),it=(n("4989"),n("ab8b"),Object(a["c"])(N));it.use(M).use(rt).use(ot["a"]),it.mount("#app")},f099:function(e,t,n){var r={"./advancedFormat":"8f19","./advancedFormat.d":"23cb6","./advancedFormat.d.ts":"23cb6","./advancedFormat.js":"8f19","./arraySupport":"eea7","./arraySupport.d":"5157","./arraySupport.d.ts":"5157","./arraySupport.js":"eea7","./badMutable":"bff7","./badMutable.d":"f5cb","./badMutable.d.ts":"f5cb","./badMutable.js":"bff7","./buddhistEra":"dd46","./buddhistEra.d":"1517","./buddhistEra.d.ts":"1517","./buddhistEra.js":"dd46","./calendar":"1c1c","./calendar.d":"8f7b","./calendar.d.ts":"8f7b","./calendar.js":"1c1c","./customParseFormat":"f906","./customParseFormat.d":"ccd7","./customParseFormat.d.ts":"ccd7","./customParseFormat.js":"f906","./dayOfYear":"8d82","./dayOfYear.d":"80f4","./dayOfYear.d.ts":"80f4","./dayOfYear.js":"8d82","./devHelper":"85c1","./devHelper.d":"d82b","./devHelper.d.ts":"d82b","./devHelper.js":"85c1","./duration":"d772","./duration.d":"7ce6","./duration.d.ts":"7ce6","./duration.js":"d772","./isBetween":"e418","./isBetween.d":"444f","./isBetween.d.ts":"444f","./isBetween.js":"e418","./isLeapYear":"04ee","./isLeapYear.d":"8891","./isLeapYear.d.ts":"8891","./isLeapYear.js":"04ee","./isMoment":"4bde","./isMoment.d":"9f59","./isMoment.d.ts":"9f59","./isMoment.js":"4bde","./isSameOrAfter":"d758","./isSameOrAfter.d":"55ef","./isSameOrAfter.d.ts":"55ef","./isSameOrAfter.js":"d758","./isSameOrBefore":"b375","./isSameOrBefore.d":"bda5","./isSameOrBefore.d.ts":"bda5","./isSameOrBefore.js":"b375","./isToday":"83dc","./isToday.d":"44fa","./isToday.d.ts":"44fa","./isToday.js":"83dc","./isTomorrow":"de19","./isTomorrow.d":"c0e5","./isTomorrow.d.ts":"c0e5","./isTomorrow.js":"de19","./isYesterday":"c4a1","./isYesterday.d":"7270","./isYesterday.d.ts":"7270","./isYesterday.js":"c4a1","./isoWeek":"5e77","./isoWeek.d":"091b","./isoWeek.d.ts":"091b","./isoWeek.js":"5e77","./isoWeeksInYear":"5a5a","./isoWeeksInYear.d":"c5c2","./isoWeeksInYear.d.ts":"c5c2","./isoWeeksInYear.js":"5a5a","./localeData":"5e0f","./localeData.d":"f94f","./localeData.d.ts":"f94f","./localeData.js":"5e0f","./localizedFormat":"23ad","./localizedFormat.d":"5df3","./localizedFormat.d.ts":"5df3","./localizedFormat.js":"23ad","./minMax":"4650","./minMax.d":"5286","./minMax.d.ts":"5286","./minMax.js":"4650","./objectSupport":"0122","./objectSupport.d":"99d6","./objectSupport.d.ts":"99d6","./objectSupport.js":"0122","./pluralGetSet":"8bdc","./pluralGetSet.d":"a5bd","./pluralGetSet.d.ts":"a5bd","./pluralGetSet.js":"8bdc","./preParsePostFormat":"05bf","./preParsePostFormat.d":"843e","./preParsePostFormat.d.ts":"843e","./preParsePostFormat.js":"05bf","./quarterOfYear":"9b1f","./quarterOfYear.d":"d04b","./quarterOfYear.d.ts":"d04b","./quarterOfYear.js":"9b1f","./relativeTime":"4208","./relativeTime.d":"d000","./relativeTime.d.ts":"d000","./relativeTime.js":"4208","./timezone":"1953","./timezone.d":"6601","./timezone.d.ts":"6601","./timezone.js":"1953","./toArray":"d163","./toArray.d":"2fac","./toArray.d.ts":"2fac","./toArray.js":"d163","./toObject":"d186","./toObject.d":"ee32","./toObject.d.ts":"ee32","./toObject.js":"d186","./updateLocale":"b002","./updateLocale.d":"a9b7","./updateLocale.d.ts":"a9b7","./updateLocale.js":"b002","./utc":"0ecf","./utc.d":"cdb3","./utc.d.ts":"cdb3","./utc.js":"0ecf","./weekOfYear":"2a04","./weekOfYear.d":"88e7","./weekOfYear.d.ts":"88e7","./weekOfYear.js":"2a04","./weekYear":"1ac8","./weekYear.d":"8ab7","./weekYear.d.ts":"8ab7","./weekYear.js":"1ac8","./weekday":"7e21","./weekday.d":"7264","./weekday.d.ts":"7264","./weekday.js":"7e21"};function o(e){var t=i(e);return n(t)}function i(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id="f099"},fdbf:function(e,t,n){}});
//# sourceMappingURL=app.02b67ee8.js.map